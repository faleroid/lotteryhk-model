<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mark Six Prediction AI</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link
        href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@400;600;700&family=Poppins:wght@400;600;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>

<body>
    <div class="header">
        <div class="logo-area">
            <img src="{{ url_for('static', filename='images/lottery_logo.svg') }}" alt="Logo" style="height: 50px;">
        </div>
    </div>

    <div class="container">
        <h1>Mark Six Prediction AI</h1>
        <div class="subtitle">
            Leveraging <strong>Random Forest</strong> classification with <strong>Time-Series Rolling Window</strong>
            validation.
            Trained on historical data (1993-2025) sourced from the <a href="https://lottery.hk/en/mark-six">Mark Six
                website</a>.
        </div>

        {% if error %}
        <div class="error-msg">{{ error }}</div>
        {% endif %}

        <div class="card">
            <h3 class="draw-title">SELECT DRAW DATE</h3>
            <form method="POST" action="/" id="predictionForm">
                <div class="date-form">
                    <select id="year" name="year"></select>
                    <select id="month" name="month"></select>
                    <select id="day" name="day"></select>
                </div>
                <button type="submit" id="predictBtn">
                    <span class="btn-text">Predict</span>
                    <div class="spinner"></div>
                </button>
            </form>
        </div>

        {% if result %}
        <!-- 2. AI Prediction Result -->
        <div class="card">
            <div class="card-predict-header">
                <h3 class="card-title">
                    AI PREDICTION
                    {% if result.data_source == 'Training Data' %}
                    <span class="badge badge-training">Train</span>
                    {% elif result.data_source == 'Testing Data' %}
                    <span class="badge badge-testing">Test</span>
                    {% endif %}
                </h3>
                <div
                    style="text-align: center; margin-bottom: 15px; color: #555; font-size: 0.95rem; font-weight: 600;">
                    <i class="fa-regular fa-calendar-days" style="margin-right: 5px;"></i>{{ result.date }}
                </div>
            </div>
            <div class="ball-container">
                {% for ball in result.pred_balls %}
                <div class="ball {{ ball.color }}"
                    style="animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; opacity: 0; animation-delay: {{ loop.index * 0.1 }}s;">
                    <span>{{ ball.num }}</span>
                </div>
                {% endfor %}
            </div>
        </div>

        <!-- 3. Actual Result -->
        <div class="card">
            <div class="card-predict-header">
                <h3 class="card-title">ACTUAL RESULT</h3>
                <div
                    style="text-align: center; margin-bottom: 15px; color: #555; font-size: 0.95rem; font-weight: 600;">
                    <i class="fa-solid fa-percent" style="margin-right: 5px;"></i> {{ (result.accuracy / 6 * 100) |
                    round | int }}% Correct
                </div>
            </div>
            <div class="ball-container">
                {% for ball in result.true_balls %}
                <div class="ball {{ ball.color }}"
                    style="animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; opacity: 0; animation-delay: {{ loop.index * 0.1 + 0.5 }}s;">
                    <span>{{ ball.num }}</span>
                </div>
                {% endfor %}

                {% if result.special_ball %}
                <div
                    style="font-size: 2rem; font-weight: 900; margin: 0 10px; color: black; animation: popIn 0.5s forwards; opacity: 0; animation-delay: 1.2s;">
                    <i class="fa-solid fa-plus"></i>
                </div>
                <div class="ball {{ result.special_ball.color }}"
                    style="animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; opacity: 0; animation-delay: 1.3s;">
                    <span>{{ result.special_ball.num }}</span>
                </div>
                {% endif %}
            </div>
        </div>

        <!-- 4. Accuracy Stats -->
        <div class="card">
            <h3 class="card-title" style="justify-content: center;">PREDICTION ACCURACY</h3>

            <div class="accuracy-content">
                <div class="circular-chart"
                    style="background: conic-gradient(#e31a35 {{ (result.accuracy / 6 * 100) }}%, #f0f0f0 0);">
                    <div class="inner-content">
                        <span class="big-score">{{ result.accuracy }}</span>
                        <span class="small-total">/ 6</span>
                    </div>
                </div>
            </div>

            <div class="accuracy-footer">
                <span>Model Successfully Predicted {{ result.accuracy }} Numbers</span>
            </div>
        </div>
        {% endif %}
    </div>
    <div class="footer">
        <p>@2025 Artificial Intelligence - Jenderal Soedirman University</p>
    </div>


    <!-- JavaScript untuk Dropdown dan Loading -->
    <script>
        const validDates = {{ valid_dates | tojson }};
    </script>
    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
</body>

</html>